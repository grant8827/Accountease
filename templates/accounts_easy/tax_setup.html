{% extends 'base.html' %}

{% block title %}Tax Setup - {{ business.name }} - Accounts Easy{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="mb-6">
        <h1 class="text-3xl font-bold text-gray-900">Tax Configuration</h1>
        <p class="text-gray-600 mt-2">Configure tax rates and thresholds for {{ business.name }}</p>
    </div>

    <form method="post" class="space-y-8">
        {% csrf_token %}
        
        <div class="bg-white shadow rounded-lg">
            <div class="px-6 py-4 border-b border-gray-200">
                <h2 class="text-xl font-semibold text-gray-800">Tax Rates</h2>
                <p class="text-sm text-gray-600 mt-1">Set the tax rates applicable to your business</p>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-6">
                        <div>
                            <label for="paye_rate" class="block text-sm font-medium text-gray-700 mb-2">
                                PAYE Tax Rate
                            </label>
                            <div class="relative">
                                <input 
                                    type="number" 
                                    id="paye_rate" 
                                    name="paye_rate" 
                                    value="{{ payroll_config.paye_rate }}"
                                    step="0.01" 
                                    min="0" 
                                    max="1"
                                    class="w-full px-3 py-2 pr-12 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" 
                                    required
                                >
                                <span class="absolute right-3 top-2 text-gray-500">%</span>
                            </div>
                            <p class="mt-1 text-sm text-gray-500">Standard rate: 25% (0.25)</p>
                        </div>

                        <div>
                            <label for="nis_rate" class="block text-sm font-medium text-gray-700 mb-2">
                                NIS Contribution Rate
                            </label>
                            <div class="relative">
                                <input 
                                    type="number" 
                                    id="nis_rate" 
                                    name="nis_rate" 
                                    value="{{ payroll_config.nis_rate }}"
                                    step="0.01" 
                                    min="0" 
                                    max="1"
                                    class="w-full px-3 py-2 pr-12 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" 
                                    required
                                >
                                <span class="absolute right-3 top-2 text-gray-500">%</span>
                            </div>
                            <p class="mt-1 text-sm text-gray-500">Standard rate: 3% (0.03)</p>
                        </div>

                        <div>
                            <label for="nht_rate" class="block text-sm font-medium text-gray-700 mb-2">
                                NHT Contribution Rate
                            </label>
                            <div class="relative">
                                <input 
                                    type="number" 
                                    id="nht_rate" 
                                    name="nht_rate" 
                                    value="{{ payroll_config.nht_rate }}"
                                    step="0.01" 
                                    min="0" 
                                    max="1"
                                    class="w-full px-3 py-2 pr-12 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" 
                                    required
                                >
                                <span class="absolute right-3 top-2 text-gray-500">%</span>
                            </div>
                            <p class="mt-1 text-sm text-gray-500">Standard rate: 2% (0.02)</p>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <div>
                            <label for="heart_rate" class="block text-sm font-medium text-gray-700 mb-2">
                                HEART Contribution Rate
                            </label>
                            <div class="relative">
                                <input 
                                    type="number" 
                                    id="heart_rate" 
                                    name="heart_rate" 
                                    value="{{ payroll_config.heart_rate }}"
                                    step="0.001" 
                                    min="0" 
                                    max="1"
                                    class="w-full px-3 py-2 pr-12 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" 
                                    required
                                >
                                <span class="absolute right-3 top-2 text-gray-500">%</span>
                            </div>
                            <p class="mt-1 text-sm text-gray-500">Standard rate: 3% (0.03)</p>
                        </div>

                        <div>
                            <label for="ed_rate" class="block text-sm font-medium text-gray-700 mb-2">
                                Education Tax Rate
                            </label>
                            <div class="relative">
                                <input 
                                    type="number" 
                                    id="ed_rate" 
                                    name="ed_rate" 
                                    value="{{ payroll_config.ed_rate }}"
                                    step="0.001" 
                                    min="0" 
                                    max="1"
                                    class="w-full px-3 py-2 pr-12 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" 
                                    required
                                >
                                <span class="absolute right-3 top-2 text-gray-500">%</span>
                            </div>
                            <p class="mt-1 text-sm text-gray-500">Standard rate: 2.25% (0.0225)</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="bg-white shadow rounded-lg">
            <div class="px-6 py-4 border-b border-gray-200">
                <h2 class="text-xl font-semibold text-gray-800">Tax Thresholds & Ceilings</h2>
                <p class="text-sm text-gray-600 mt-1">Set income thresholds and contribution limits</p>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="paye_threshold" class="block text-sm font-medium text-gray-700 mb-2">
                            Annual PAYE Threshold
                        </label>
                        <div class="relative">
                            <span class="absolute left-3 top-2 text-gray-500">$</span>
                            <input 
                                type="number" 
                                id="paye_threshold" 
                                name="paye_threshold" 
                                value="{{ payroll_config.paye_threshold }}"
                                class="w-full pl-8 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" 
                                required
                            >
                        </div>
                        <p class="mt-1 text-sm text-gray-500">Income below this amount is not subject to PAYE</p>
                    </div>

                    <div>
                        <label for="nis_ceiling" class="block text-sm font-medium text-gray-700 mb-2">
                            Annual NIS Ceiling
                        </label>
                        <div class="relative">
                            <span class="absolute left-3 top-2 text-gray-500">$</span>
                            <input 
                                type="number" 
                                id="nis_ceiling" 
                                name="nis_ceiling" 
                                value="{{ payroll_config.nis_ceiling }}"
                                class="w-full pl-8 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" 
                                required
                            >
                        </div>
                        <p class="mt-1 text-sm text-gray-500">Maximum annual income subject to NIS contributions</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="flex justify-end space-x-4">
            <a href="{% url 'accounts_easy:payroll_setup' %}" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-md transition duration-300">
                Back to Payroll Setup
            </a>
            <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-md transition duration-300">
                Update Tax Configuration
            </button>
        </div>
    </form>

    <!-- Tax Information -->
    <div class="mt-8 bg-blue-50 border border-blue-200 rounded-lg p-6">
        <h3 class="text-lg font-medium text-blue-900 mb-4">Jamaica Tax Information</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <h4 class="font-medium text-blue-800 mb-2">Current Standard Rates (2024)</h4>
                <ul class="text-sm text-blue-700 space-y-1">
                    <li>• <strong>PAYE:</strong> 25% on income above $1.5M annually</li>
                    <li>• <strong>NIS:</strong> 3% on income up to $5M annually</li>
                    <li>• <strong>NHT:</strong> 2% on all income</li>
                    <li>• <strong>HEART:</strong> 3% on payroll</li>
                    <li>• <strong>Education Tax:</strong> 2.25% on payroll</li>
                </ul>
            </div>
            <div>
                <h4 class="font-medium text-blue-800 mb-2">Important Notes</h4>
                <ul class="text-sm text-blue-700 space-y-1">
                    <li>• Rates may change annually</li>
                    <li>• Consult with your accountant for latest rates</li>
                    <li>• Some taxes are shared between employer/employee</li>
                    <li>• Keep records of all deductions</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}
